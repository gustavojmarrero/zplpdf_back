{"version":3,"sources":["../../../../src/modules/admin/dto/admin-users.dto.ts"],"sourcesContent":["import { ApiProperty, ApiPropertyOptional } from '@nestjs/swagger';\nimport {\n  IsOptional,\n  IsString,\n  IsNumber,\n  Min,\n  Max,\n  IsEnum,\n  IsDateString,\n  IsNotEmpty,\n  MaxLength,\n} from 'class-validator';\nimport { Type } from 'class-transformer';\n\nexport class GetUsersQueryDto {\n  @ApiPropertyOptional({ default: 1 })\n  @IsOptional()\n  @Type(() => Number)\n  @IsNumber()\n  @Min(1)\n  page?: number = 1;\n\n  @ApiPropertyOptional({ default: 50, maximum: 100 })\n  @IsOptional()\n  @Type(() => Number)\n  @IsNumber()\n  @Min(1)\n  @Max(100)\n  limit?: number = 50;\n\n  @ApiPropertyOptional({ enum: ['free', 'pro', 'enterprise'] })\n  @IsOptional()\n  @IsString()\n  plan?: string;\n\n  @ApiPropertyOptional({ description: 'Search by email or name' })\n  @IsOptional()\n  @IsString()\n  search?: string;\n\n  @ApiPropertyOptional({ enum: ['createdAt', 'lastActiveAt', 'pdfCount'], default: 'createdAt' })\n  @IsOptional()\n  @IsString()\n  sortBy?: string = 'createdAt';\n\n  @ApiPropertyOptional({ enum: ['asc', 'desc'], default: 'desc' })\n  @IsOptional()\n  @IsEnum(['asc', 'desc'])\n  sortOrder?: 'asc' | 'desc' = 'desc';\n\n  @ApiPropertyOptional({ description: 'Filter by registration date from (ISO 8601)' })\n  @IsOptional()\n  @IsDateString()\n  dateFrom?: string;\n\n  @ApiPropertyOptional({ description: 'Filter by registration date to (ISO 8601)' })\n  @IsOptional()\n  @IsDateString()\n  dateTo?: string;\n}\n\nclass UserUsageDto {\n  @ApiProperty()\n  pdfCount: number;\n\n  @ApiProperty()\n  labelCount: number;\n}\n\nclass AdminUserDto {\n  @ApiProperty()\n  id: string;\n\n  @ApiProperty()\n  email: string;\n\n  @ApiProperty({ required: false })\n  displayName?: string;\n\n  @ApiProperty({ enum: ['free', 'pro', 'enterprise'] })\n  plan: string;\n\n  @ApiProperty({ type: UserUsageDto })\n  usage: UserUsageDto;\n\n  @ApiProperty()\n  createdAt: Date;\n\n  @ApiProperty({ required: false })\n  lastActiveAt?: Date;\n}\n\nclass PaginationDto {\n  @ApiProperty()\n  page: number;\n\n  @ApiProperty()\n  limit: number;\n\n  @ApiProperty()\n  total: number;\n\n  @ApiProperty()\n  totalPages: number;\n}\n\nclass AdminUsersDataDto {\n  @ApiProperty({ type: [AdminUserDto] })\n  users: AdminUserDto[];\n\n  @ApiProperty({ type: PaginationDto })\n  pagination: PaginationDto;\n}\n\nexport class AdminUsersResponseDto {\n  @ApiProperty()\n  success: boolean;\n\n  @ApiProperty({ type: AdminUsersDataDto })\n  data: AdminUsersDataDto;\n}\n\n// ==================== User Detail DTOs ====================\n\nclass UserUsageDetailDto {\n  @ApiProperty({ description: 'PDFs generated in current period' })\n  pdfCount: number;\n\n  @ApiProperty({ description: 'Labels generated in current period' })\n  labelCount: number;\n\n  @ApiProperty({ description: 'PDF limit for the plan' })\n  pdfLimit: number;\n\n  @ApiProperty({ description: 'Percentage of limit used' })\n  percentUsed: number;\n}\n\nclass UsageHistoryItemDto {\n  @ApiProperty({ description: 'Date (YYYY-MM-DD)' })\n  date: string;\n\n  @ApiProperty({ description: 'PDFs generated that day' })\n  pdfs: number;\n\n  @ApiProperty({ description: 'Labels generated that day' })\n  labels: number;\n}\n\nclass SubscriptionInfoDto {\n  @ApiProperty({\n    description: 'Subscription status',\n    enum: ['active', 'canceled', 'past_due', 'unpaid', 'trialing', 'incomplete'],\n  })\n  status: string;\n\n  @ApiProperty({ description: 'Current period start date' })\n  currentPeriodStart: string;\n\n  @ApiProperty({ description: 'Current period end date' })\n  currentPeriodEnd: string;\n\n  @ApiPropertyOptional({ description: 'Stripe customer ID' })\n  stripeCustomerId?: string;\n\n  @ApiPropertyOptional({ description: 'Will cancel at period end' })\n  cancelAtPeriodEnd?: boolean;\n}\n\nclass UserDetailDataDto {\n  @ApiProperty()\n  id: string;\n\n  @ApiProperty()\n  email: string;\n\n  @ApiPropertyOptional()\n  displayName?: string;\n\n  @ApiProperty({ enum: ['free', 'pro', 'enterprise'] })\n  plan: string;\n\n  @ApiProperty({ type: UserUsageDetailDto })\n  usage: UserUsageDetailDto;\n\n  @ApiProperty({ type: [UsageHistoryItemDto], description: 'Usage history for the last 30 days' })\n  usageHistory: UsageHistoryItemDto[];\n\n  @ApiPropertyOptional({ type: SubscriptionInfoDto })\n  subscription?: SubscriptionInfoDto;\n\n  @ApiProperty()\n  createdAt: string;\n\n  @ApiPropertyOptional()\n  lastActiveAt?: string;\n}\n\nexport class AdminUserDetailResponseDto {\n  @ApiProperty()\n  success: boolean;\n\n  @ApiProperty({ type: UserDetailDataDto })\n  data: UserDetailDataDto;\n}\n\n// ==================== Update Plan DTOs ====================\n\nexport class UpdateUserPlanDto {\n  @ApiProperty({\n    enum: ['free', 'pro', 'enterprise'],\n    description: 'New plan to assign',\n  })\n  @IsEnum(['free', 'pro', 'enterprise'], {\n    message: 'Plan must be: free, pro, or enterprise',\n  })\n  @IsNotEmpty()\n  newPlan: 'free' | 'pro' | 'enterprise';\n\n  @ApiProperty({\n    description: 'Reason for the plan change',\n    maxLength: 500,\n  })\n  @IsString()\n  @IsNotEmpty()\n  @MaxLength(500)\n  reason: string;\n}\n\nclass UpdatePlanResultDto {\n  @ApiProperty()\n  userId: string;\n\n  @ApiProperty({ enum: ['free', 'pro', 'enterprise'] })\n  previousPlan: string;\n\n  @ApiProperty({ enum: ['free', 'pro', 'enterprise'] })\n  newPlan: string;\n\n  @ApiProperty()\n  effectiveAt: string;\n\n  @ApiPropertyOptional({ description: 'Whether Stripe subscription was canceled' })\n  stripeCanceled?: boolean;\n\n  @ApiPropertyOptional({ description: 'Warnings during the process', type: [String] })\n  warnings?: string[];\n}\n\nexport class UpdateUserPlanResponseDto {\n  @ApiProperty()\n  success: boolean;\n\n  @ApiProperty({ type: UpdatePlanResultDto })\n  data: UpdatePlanResultDto;\n}\n"],"names":["ApiProperty","ApiPropertyOptional","IsOptional","IsString","IsNumber","Min","Max","IsEnum","IsDateString","IsNotEmpty","MaxLength","Type","GetUsersQueryDto","page","limit","sortBy","sortOrder","default","Number","maximum","enum","description","UserUsageDto","AdminUserDto","required","type","PaginationDto","AdminUsersDataDto","AdminUsersResponseDto","UserUsageDetailDto","UsageHistoryItemDto","SubscriptionInfoDto","UserDetailDataDto","AdminUserDetailResponseDto","UpdateUserPlanDto","message","maxLength","UpdatePlanResultDto","String","UpdateUserPlanResponseDto"],"mappings":";;;;;;;;;AAAA,SAASA,WAAW,EAAEC,mBAAmB,QAAQ,kBAAkB;AACnE,SACEC,UAAU,EACVC,QAAQ,EACRC,QAAQ,EACRC,GAAG,EACHC,GAAG,EACHC,MAAM,EACNC,YAAY,EACZC,UAAU,EACVC,SAAS,QACJ,kBAAkB;AACzB,SAASC,IAAI,QAAQ,oBAAoB;AAEzC,OAAO,MAAMC;;aAMXC,OAAgB;aAQhBC,QAAiB;aAejBC,SAAkB;aAKlBC,YAA6B;;AAW/B;;;QA5CyBC,SAAS;;;aAEpBC;;;;;;;QAKWD,SAAS;QAAIE,SAAS;;;aAEjCD;;;;;;;;QAMWE,MAAM;YAAC;YAAQ;YAAO;SAAa;;;;;;;;QAKnCC,aAAa;;;;;;;;QAKbD,MAAM;YAAC;YAAa;YAAgB;SAAW;QAAEH,SAAS;;;;;;;;QAK1DG,MAAM;YAAC;YAAO;SAAO;QAAEH,SAAS;;;;QAE9C;QAAO;;;;;;QAGOI,aAAa;;;;;;;;QAKbA,aAAa;;;;;;AAMtC,IAAA,AAAMC,eAAN,MAAMA;AAMN;;;;;;;;;AAEA,IAAA,AAAMC,eAAN,MAAMA;AAqBN;;;;;;;;;;;QAdiBC,UAAU;;;;;;QAGVJ,MAAM;YAAC;YAAQ;YAAO;SAAa;;;;;;QAGnCK,MAAMH;;;;;;;;;;QAMNE,UAAU;;;;AAI3B,IAAA,AAAME,gBAAN,MAAMA;AAYN;;;;;;;;;;;;;;;;;AAEA,IAAA,AAAMC,oBAAN,MAAMA;AAMN;;;QALiBF,MAAM;YAACF;SAAa;;;;;;QAGpBE,MAAMC;;;;AAIvB,OAAO,MAAME;AAMb;;;;;;;QAFiBH,MAAME;;;;AAIvB,6DAA6D;AAE7D,IAAA,AAAME,qBAAN,MAAMA;AAYN;;;QAXiBR,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;AAI9B,IAAA,AAAMS,sBAAN,MAAMA;AASN;;;QARiBT,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;AAI9B,IAAA,AAAMU,sBAAN,MAAMA;AAkBN;;;QAhBIV,aAAa;QACbD,MAAM;YAAC;YAAU;YAAY;YAAY;YAAU;YAAY;SAAa;;;;;;QAI/DC,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGLA,aAAa;;;;;;QAGbA,aAAa;;;;AAItC,IAAA,AAAMW,oBAAN,MAAMA;AA2BN;;;;;;;;;;;;;;;QAjBiBZ,MAAM;YAAC;YAAQ;YAAO;SAAa;;;;;;QAGnCK,MAAMI;;;;;;QAGNJ,MAAM;YAACK;SAAoB;QAAET,aAAa;;;;;;QAGlCI,MAAMM;;;;;;;;;;;;AAU/B,OAAO,MAAME;AAMb;;;;;;;QAFiBR,MAAMO;;;;AAIvB,6DAA6D;AAE7D,OAAO,MAAME;AAmBb;;;QAjBId,MAAM;YAAC;YAAQ;YAAO;SAAa;QACnCC,aAAa;;;QAEN;QAAQ;QAAO;;QACtBc,SAAS;;;;;;;QAMTd,aAAa;QACbe,WAAW;;;;;;;AAQf,IAAA,AAAMC,sBAAN,MAAMA;AAkBN;;;;;;;QAdiBjB,MAAM;YAAC;YAAQ;YAAO;SAAa;;;;;;QAGnCA,MAAM;YAAC;YAAQ;YAAO;SAAa;;;;;;;;;;QAM3BC,aAAa;;;;;;QAGbA,aAAa;QAA+BI,MAAM;YAACa;SAAO;;;;AAInF,OAAO,MAAMC;AAMb;;;;;;;QAFiBd,MAAMY"}